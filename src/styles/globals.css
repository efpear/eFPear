@tailwind base;
@tailwind components;
@tailwind utilities;

/* ================================================================
   eFPear design tokens -- OAT-compatible CSS custom properties
   ================================================================ */

@layer base {
  :root {
    /* Core palette */
    --background:          #f8fafc;
    --foreground:          #0f172a;
    --card:                #ffffff;
    --card-foreground:     #0f172a;
    --primary:             #059669;
    --primary-foreground:  #ffffff;
    --secondary:           #f1f5f9;
    --secondary-foreground:#0f172a;
    --muted:               #f1f5f9;
    --muted-foreground:    #64748b;
    --faint:               #f8fafc;
    --faint-foreground:    #94a3b8;
    --accent:              #e2e8f0;
    --accent-foreground:   #0f172a;
    --danger:              #dc2626;
    --danger-foreground:   #ffffff;
    --success:             #059669;
    --success-foreground:  #ffffff;
    --warning:             #d97706;
    --warning-foreground:  #0f172a;
    --border:              #e2e8f0;
    --input:               #cbd5e1;
    --ring:                #059669;

    /* Radii */
    --radius:              0.5rem;
    --radius-small:        0.125rem;
    --radius-medium:       0.375rem;
    --radius-large:        0.75rem;
    --radius-full:         9999px;

    /* Spacing */
    --space-1: 0.25rem;  --space-2: 0.5rem;   --space-3: 0.75rem;
    --space-4: 1rem;     --space-5: 1.25rem;  --space-6: 1.5rem;
    --space-8: 2rem;     --space-10: 2.5rem;

    /* Typography */
    --font-sans: 'Inter', system-ui, -apple-system, sans-serif;
    --font-mono: ui-monospace, Consolas, monospace;
    --text-7: 0.875rem;
    --text-8: 0.75rem;
    --text-regular: 1rem;
    --font-medium: 500;
    --font-semibold: 600;
    --leading-normal: 1.5;

    /* Elevation */
    --shadow-small:  0 1px 2px 0 rgb(0 0 0 / 0.05);
    --shadow-medium: 0 1px 3px 0 rgb(0 0 0 / 0.1), 0 1px 2px -1px rgb(0 0 0 / 0.1);

    /* Transitions */
    --transition-fast: 120ms cubic-bezier(0.4, 0, 0.2, 1);
    --transition:      200ms cubic-bezier(0.4, 0, 0.2, 1);

    /* Bar / progress */
    --bar-height: 0.375rem;
  }

  body {
    background-color: var(--background);
    color: var(--foreground);
    font-family: var(--font-sans);
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
  }

  /* ---- Progress element (OAT-style) ---- */
  progress {
    appearance: none;
    width: 100%;
    height: var(--bar-height);
    border: none;
    border-radius: var(--radius-full);
    overflow: hidden;
    background-color: var(--muted);
    display: block;
  }
  progress::-webkit-progress-bar {
    background-color: var(--muted);
    border-radius: var(--radius-full);
  }
  progress::-webkit-progress-value {
    background-color: var(--progress-color, var(--primary));
    border-radius: var(--radius-full);
    transition: width var(--transition);
  }
  progress::-moz-progress-bar {
    background-color: var(--progress-color, var(--primary));
    border-radius: var(--radius-full);
  }

  /* ---- Accordion / details (OAT-style) ---- */
  details.accordion {
    border: 1px solid var(--border);
    border-radius: var(--radius-medium);
    overflow: hidden;
  }
  details.accordion[open] > summary {
    border-bottom: 1px solid var(--border);
  }
  details.accordion > *:not(summary) {
    padding: var(--space-4);
  }
  details.accordion > summary {
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: var(--space-2);
    padding: var(--space-3) var(--space-4);
    font-size: var(--text-7);
    font-weight: var(--font-medium);
    cursor: pointer;
    user-select: none;
    transition: background-color var(--transition-fast);
    list-style: none;
  }
  details.accordion > summary:hover {
    background-color: var(--muted);
  }
  details.accordion > summary::-webkit-details-marker { display: none; }
  details.accordion > summary::marker { display: none; }
  details.accordion > summary::after {
    content: "";
    width: 1em;
    height: 1em;
    flex-shrink: 0;
    background-color: currentColor;
    mask-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2'%3E%3Cpath d='m6 9 6 6 6-6'/%3E%3C/svg%3E");
    mask-size: contain;
    mask-repeat: no-repeat;
    transition: transform var(--transition-fast);
    opacity: 0.5;
  }
  details.accordion[open] > summary::after {
    transform: rotate(180deg);
  }
}

/* ================================================================
   OAT component classes
   ================================================================ */

@layer components {

  /* ---- Card ---- */
  .oat-card {
    background-color: var(--card);
    color: var(--card-foreground);
    border: 1px solid var(--border);
    border-radius: var(--radius-large);
    box-shadow: var(--shadow-small);
    overflow: hidden;
  }

  /* ---- Badge ---- */
  .oat-badge {
    display: inline-flex;
    align-items: center;
    gap: var(--space-1);
    padding: calc(var(--space-1) * 0.75) var(--space-2);
    font-size: var(--text-8);
    font-weight: var(--font-semibold);
    line-height: var(--leading-normal);
    border-radius: var(--radius-full);
    white-space: nowrap;
    letter-spacing: 0.01em;
    border: 1px solid transparent;
  }
  .oat-badge.secondary {
    background-color: var(--secondary);
    color: var(--secondary-foreground);
    border-color: var(--border);
  }
  .oat-badge.success {
    background-color: color-mix(in srgb, var(--success) 12%, transparent);
    color: var(--success);
  }
  .oat-badge.warning {
    background-color: color-mix(in srgb, var(--warning) 12%, transparent);
    color: var(--warning);
  }
  .oat-badge.danger {
    background-color: color-mix(in srgb, var(--danger) 12%, transparent);
    color: var(--danger);
  }
  .oat-badge.outline {
    background-color: transparent;
    color: var(--foreground);
    border-color: var(--border);
  }

  /* ---- Tab list (OAT semantic pattern) ---- */
  [role="tablist"].oat-tabs {
    display: inline-flex;
    align-items: center;
    gap: var(--space-1);
    padding: var(--space-1);
    background-color: var(--muted);
    border-radius: var(--radius-medium);
  }
  [role="tablist"].oat-tabs [role="tab"] {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    gap: var(--space-2);
    padding: calc(var(--space-2) * 0.875) var(--space-3);
    font-size: var(--text-8);
    font-weight: var(--font-medium);
    white-space: nowrap;
    background-color: transparent;
    color: var(--muted-foreground);
    border: none;
    border-radius: calc(var(--radius-medium) - 2px);
    cursor: pointer;
    transition: background-color var(--transition-fast), color var(--transition-fast);
  }
  [role="tablist"].oat-tabs [role="tab"]:hover {
    color: var(--foreground);
  }
  [role="tablist"].oat-tabs [role="tab"][aria-selected="true"] {
    background-color: var(--card);
    color: var(--foreground);
    box-shadow: var(--shadow-small);
  }

  /* ---- Stat tile ---- */
  .oat-stat {
    display: flex;
    flex-direction: column;
    gap: 2px;
    text-align: center;
  }
  .oat-stat-value {
    font-size: var(--text-7);
    font-weight: var(--font-semibold);
    color: var(--foreground);
    font-variant-numeric: tabular-nums;
    line-height: 1.2;
  }
  .oat-stat-label {
    font-size: var(--text-8);
    color: var(--muted-foreground);
    line-height: 1.2;
  }

  /* ---- Module card accent bar (left border colour via CSS var) ---- */
  .oat-module-card {
    background-color: var(--card);
    border: 1px solid var(--border);
    border-radius: var(--radius-large);
    border-left: 4px solid var(--mc, var(--primary));
    box-shadow: var(--shadow-small);
    overflow: hidden;
  }
}

/* ================================================================
   Legacy eFPear utilities (kept for backward compat)
   ================================================================ */
@layer utilities {
  .efpear-gradient {
    @apply bg-gradient-to-br from-green-600 to-green-800;
  }
}
